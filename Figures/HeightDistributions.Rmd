---
title: "Height_Distributions"
author: "Ben Weinstein"
date: "3/10/2020"
output: html_document
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
library(raster)
library(dplyr)
library(ggplot2)
library(tidyr)
library(stringr)
```

```{r}
df<-read.csv("averages.csv",row.names =1)
```

```{r}
ggplot(df,aes(x=height,y=area,size=n)) + geom_point(alpha=0.5) + labs(x="Crown Height (m)",y="Crown Area (m^2)",size="Trees/km^2") + geom_text(aes(label=Site),size=3,hjust=0.25,vjust=-0.5) + theme_bw()
ggsave("Attributes.png",height=5,width=8)
ggsave("Attributes.svg", height=5,width=8)
```

### Over time
```{r}
ggplot(df,aes(x=height,fill=Year)) + geom_density(alpha=0.9)  + labs(x="99th quantile Crown Height (m)") + facet_wrap(~Site,scales="free") + theme_bw()
ggsave("/home/b.weinstein/NEON_crown_maps/Figures/TimeHeight_example.png",height=6,width=9)
```

## Counts over time

```{r}
ydf<-df %>% group_by(Site,geo_index,Year) %>% dplyr::summarize(n=n()) %>% spread(Year,n)
ggplot(ydf,aes(x=`2019`,y=`2018`)) + geom_point() + geom_abline() + coord_fixed()
ggsave("/home/b.weinstein/NEON_crown_maps/Figures/Counts.png",height=6,width=9)
```
